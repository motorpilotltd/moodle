if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/moodle-atto_kalturamedia-button/moodle-atto_kalturamedia-button.js']) {
   __coverage__['build/moodle-atto_kalturamedia-button/moodle-atto_kalturamedia-button.js'] = {"path":"build/moodle-atto_kalturamedia-button/moodle-atto_kalturamedia-button.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":43},"end":{"line":1,"column":62}}},"2":{"name":"(anonymous_2)","line":50,"loc":{"start":{"line":50,"column":17},"end":{"line":50,"column":28}}},"3":{"name":"(anonymous_3)","line":57,"loc":{"start":{"line":57,"column":19},"end":{"line":57,"column":30}}},"4":{"name":"(anonymous_4)","line":84,"loc":{"start":{"line":84,"column":19},"end":{"line":84,"column":30}}},"5":{"name":"(anonymous_5)","line":97,"loc":{"start":{"line":97,"column":18},"end":{"line":97,"column":29}}},"6":{"name":"(anonymous_6)","line":113,"loc":{"start":{"line":113,"column":29},"end":{"line":113,"column":71}}},"7":{"name":"(anonymous_7)","line":119,"loc":{"start":{"line":119,"column":28},"end":{"line":119,"column":46}}},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":15},"end":{"line":123,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":180,"column":61}},"2":{"start":{"line":36,"column":0},"end":{"line":44,"column":6}},"3":{"start":{"line":46,"column":0},"end":{"line":177,"column":2}},"4":{"start":{"line":51,"column":8},"end":{"line":55,"column":15}},"5":{"start":{"line":58,"column":8},"end":{"line":58,"column":65}},"6":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"7":{"start":{"line":60,"column":12},"end":{"line":60,"column":19}},"8":{"start":{"line":63,"column":8},"end":{"line":63,"column":21}},"9":{"start":{"line":64,"column":8},"end":{"line":64,"column":20}},"10":{"start":{"line":65,"column":8},"end":{"line":65,"column":94}},"11":{"start":{"line":66,"column":8},"end":{"line":66,"column":90}},"12":{"start":{"line":68,"column":8},"end":{"line":68,"column":151}},"13":{"start":{"line":69,"column":8},"end":{"line":69,"column":157}},"14":{"start":{"line":71,"column":8},"end":{"line":71,"column":60}},"15":{"start":{"line":72,"column":8},"end":{"line":72,"column":59}},"16":{"start":{"line":73,"column":8},"end":{"line":73,"column":195}},"17":{"start":{"line":75,"column":8},"end":{"line":75,"column":31}},"18":{"start":{"line":77,"column":8},"end":{"line":79,"column":9}},"19":{"start":{"line":78,"column":12},"end":{"line":78,"column":30}},"20":{"start":{"line":81,"column":8},"end":{"line":81,"column":37}},"21":{"start":{"line":86,"column":8},"end":{"line":92,"column":34}},"22":{"start":{"line":93,"column":8},"end":{"line":94,"column":46}},"23":{"start":{"line":98,"column":8},"end":{"line":98,"column":21}},"24":{"start":{"line":99,"column":8},"end":{"line":99,"column":77}},"25":{"start":{"line":100,"column":8},"end":{"line":100,"column":45}},"26":{"start":{"line":101,"column":8},"end":{"line":108,"column":9}},"27":{"start":{"line":103,"column":12},"end":{"line":107,"column":17}},"28":{"start":{"line":105,"column":20},"end":{"line":105,"column":54}},"29":{"start":{"line":106,"column":20},"end":{"line":106,"column":40}},"30":{"start":{"line":110,"column":8},"end":{"line":110,"column":24}},"31":{"start":{"line":114,"column":8},"end":{"line":114,"column":59}},"32":{"start":{"line":115,"column":8},"end":{"line":115,"column":53}},"33":{"start":{"line":116,"column":8},"end":{"line":116,"column":55}},"34":{"start":{"line":120,"column":8},"end":{"line":120,"column":50}},"35":{"start":{"line":124,"column":8},"end":{"line":124,"column":23}},"36":{"start":{"line":125,"column":8},"end":{"line":132,"column":9}},"37":{"start":{"line":127,"column":12},"end":{"line":127,"column":47}},"38":{"start":{"line":128,"column":12},"end":{"line":131,"column":13}},"39":{"start":{"line":130,"column":16},"end":{"line":130,"column":56}},"40":{"start":{"line":134,"column":8},"end":{"line":134,"column":48}},"41":{"start":{"line":135,"column":8},"end":{"line":135,"column":40}},"42":{"start":{"line":136,"column":8},"end":{"line":136,"column":38}},"43":{"start":{"line":137,"column":8},"end":{"line":137,"column":73}},"44":{"start":{"line":138,"column":8},"end":{"line":138,"column":49}},"45":{"start":{"line":139,"column":8},"end":{"line":139,"column":32}},"46":{"start":{"line":140,"column":8},"end":{"line":140,"column":29}},"47":{"start":{"line":142,"column":8},"end":{"line":142,"column":144}},"48":{"start":{"line":144,"column":8},"end":{"line":144,"column":32}},"49":{"start":{"line":145,"column":8},"end":{"line":145,"column":50}},"50":{"start":{"line":146,"column":8},"end":{"line":146,"column":48}},"51":{"start":{"line":147,"column":8},"end":{"line":147,"column":27}},"52":{"start":{"line":148,"column":8},"end":{"line":148,"column":33}}},"branchMap":{"1":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":59,"column":8}},{"start":{"line":59,"column":8},"end":{"line":59,"column":8}}]},"2":{"line":65,"type":"cond-expr","locations":[{"start":{"line":65,"column":62},"end":{"line":65,"column":79}},{"start":{"line":65,"column":82},"end":{"line":65,"column":93}}]},"3":{"line":66,"type":"cond-expr","locations":[{"start":{"line":66,"column":60},"end":{"line":66,"column":76}},{"start":{"line":66,"column":79},"end":{"line":66,"column":89}}]},"4":{"line":68,"type":"cond-expr","locations":[{"start":{"line":68,"column":40},"end":{"line":68,"column":57}},{"start":{"line":68,"column":60},"end":{"line":68,"column":150}}]},"5":{"line":68,"type":"cond-expr","locations":[{"start":{"line":68,"column":99},"end":{"line":68,"column":135}},{"start":{"line":68,"column":138},"end":{"line":68,"column":150}}]},"6":{"line":69,"type":"cond-expr","locations":[{"start":{"line":69,"column":42},"end":{"line":69,"column":60}},{"start":{"line":69,"column":63},"end":{"line":69,"column":156}}]},"7":{"line":69,"type":"cond-expr","locations":[{"start":{"line":69,"column":103},"end":{"line":69,"column":140}},{"start":{"line":69,"column":143},"end":{"line":69,"column":156}}]},"8":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":8},"end":{"line":77,"column":8}},{"start":{"line":77,"column":8},"end":{"line":77,"column":8}}]},"9":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":12},"end":{"line":103,"column":12}},{"start":{"line":103,"column":12},"end":{"line":103,"column":12}}]},"10":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":12},"end":{"line":128,"column":12}},{"start":{"line":128,"column":12},"end":{"line":128,"column":12}}]}},"code":["(function () { YUI.add('moodle-atto_kalturamedia-button', function (Y, NAME) {","","// This file is part of Moodle - http://moodle.org/","//","// Moodle is free software: you can redistribute it and/or modify","// it under the terms of the GNU General Public License as published by","// the Free Software Foundation, either version 3 of the License, or","// (at your option) any later version.","//","// Moodle is distributed in the hope that it will be useful,","// but WITHOUT ANY WARRANTY; without even the implied warranty of","// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the","// GNU General Public License for more details.","//","// You should have received a copy of the GNU General Public License","// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.","","/*"," * @package    atto_kalturamedia"," * @copyright  2Kaltura"," * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */","","/**"," * @module moodle-atto_kalturamedia-button"," */","","/**"," * Atto text editor kalturamedia plugin."," *"," * @namespace M.atto_kalturamedia"," * @class button"," * @extends M.editor_atto.EditorPlugin"," */","","var COMPONENTNAME = 'atto_kalturamedia',","    CSS = {","        URLINPUT: 'atto_kalturamedia_urlentry',","        NAMEINPUT: 'atto_kalturamedia_nameentry'","    },","    SELECTORS = {","        URLINPUT: '.' + CSS.URLINPUT,","        NAMEINPUT: '.' + CSS.NAMEINPUT","    };","","Y.namespace('M.atto_kalturamedia').Button = Y.Base.create('button', Y.M.editor_atto.EditorPlugin, [], {","    _currentSelection: null,","    embedWindow: null,","    ","    initializer: function() {","        this.addButton({","                //icon: 'e/icon',","                iconurl: M.cfg.wwwroot + '/lib/editor/atto/plugins/kalturamedia/pix/icon.png',","                callback: this._kalturamedia","            });","    },","    _kalturamedia: function() {","        this._currentSelection = this.get('host').getSelection();","        if (this._currentSelection === false) {","            return;","        }","","        var w = 1200;","        var h = 700;","        var dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : screen.left;","        var dualScreenTop = window.screenTop != undefined ? window.screenTop : screen.top;","","        var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;","        var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;","","        var left = ((width / 2) - (w / 2)) + dualScreenLeft;","        var top = ((height / 2) - (h / 2)) + dualScreenTop;","        var newWindow = window.open(this._getIframeURL(), M.util.get_string(\"browse_and_embed\", COMPONENTNAME), 'scrollbars=no, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);","","        window.buttonJs = this;","","        if (window.focus) {","            newWindow.focus();","        }","","        this.embedWindow = newWindow;","    },","    ","    _getIframeURL: function() {","","        var args = Y.mix({","                    elementid: this.get('host').get('elementid'),","                    contextid: this.get('contextid'),","                    height: '600px',","                    width: '1112px'","                },","                this.get('area'));","        return M.cfg.wwwroot + '/lib/editor/atto/plugins/kalturamedia/ltibrowse_container.php?' +","                Y.QueryString.stringify(args);","    },","    ","    _getCourseId: function() {","        var courseId;","        var bodyClasses = document.getElementsByTagName('body')[0].className;","        var classes = bodyClasses.split(' ');","        for(i in classes)","        {","            if(classes[i].indexOf('course-') > -1)","                {","                    var parts = classes[i].split('-');","                    courseId = parts[1];","                }","        }","        ","        return courseId;","    },","","    _replaceKafUriWithToken: function(sourceUrl, kafUri, kalturaToken) {","        sourceUrl = this._removeProtocolFromUrl(sourceUrl);","        kafUri = this._removeProtocolFromUrl(kafUri);","        return sourceUrl.replace(kafUri, kalturaToken);","    },","","    _removeProtocolFromUrl: function(fullUrl) {","        return fullUrl.replace(/^https?:\\/\\//,'');","    },","","    embedItem: function(what, data) {","        embedInfo = {};","        for(param in data)","        {","            var isEmbedInfo = param.split('-');","            if(isEmbedInfo[0] == 'embedinfo')","            {","                embedInfo[isEmbedInfo[1]] = data[param];","            }","        }","","        var token = this.get('kalturauritoken');","        var kafUri = this.get('kafuri');","        var sourceUrl = embedInfo.url;","        var url = this._replaceKafUriWithToken(sourceUrl, kafUri, token);","        var parser = document.createElement('a');","        parser.href = sourceUrl;","        url += parser.search;","        ","        var content = '<a href=\"http://'+url+'\">tinymce-kalturamedia-embed||'+embedInfo.title+'||'+embedInfo.width+'||'+embedInfo.height+'</a>';","        ","        host = this.get('host');","        host.setSelection(this._currentSelection);","        host.insertContentAtFocusPoint(content);","        this.markUpdated();","        this.embedWindow.close();","    }","    ","} , {","    ATTRS: {","        /**","         * The contextid to use when generating this preview.","         *","         * @attribute contextid","         * @type String","         */","        contextid: {","            value: null","        },","        ","       /**","        * Kaltura URI token to be placed in content for filter to catch. this is merely a placeholder to pass a CONST value into JS.","        */","        kalturauritoken: {","            value: null","        },","","        /**","         * The KAF URI, as configured in Kaltura's plugin settings.","         */","        kafuri: {","            value: null","        }","    }}",");","","","}, '@VERSION@', {\"requires\": [\"moodle-editor_atto-plugin\"]});","","}());"]};
}
var __cov_HjZTx8fE2j7fahookso83Q = __coverage__['build/moodle-atto_kalturamedia-button/moodle-atto_kalturamedia-button.js'];
__cov_HjZTx8fE2j7fahookso83Q.s['1']++;YUI.add('moodle-atto_kalturamedia-button',function(Y,NAME){__cov_HjZTx8fE2j7fahookso83Q.f['1']++;__cov_HjZTx8fE2j7fahookso83Q.s['2']++;var COMPONENTNAME='atto_kalturamedia',CSS={URLINPUT:'atto_kalturamedia_urlentry',NAMEINPUT:'atto_kalturamedia_nameentry'},SELECTORS={URLINPUT:'.'+CSS.URLINPUT,NAMEINPUT:'.'+CSS.NAMEINPUT};__cov_HjZTx8fE2j7fahookso83Q.s['3']++;Y.namespace('M.atto_kalturamedia').Button=Y.Base.create('button',Y.M.editor_atto.EditorPlugin,[],{_currentSelection:null,embedWindow:null,initializer:function(){__cov_HjZTx8fE2j7fahookso83Q.f['2']++;__cov_HjZTx8fE2j7fahookso83Q.s['4']++;this.addButton({iconurl:M.cfg.wwwroot+'/lib/editor/atto/plugins/kalturamedia/pix/icon.png',callback:this._kalturamedia});},_kalturamedia:function(){__cov_HjZTx8fE2j7fahookso83Q.f['3']++;__cov_HjZTx8fE2j7fahookso83Q.s['5']++;this._currentSelection=this.get('host').getSelection();__cov_HjZTx8fE2j7fahookso83Q.s['6']++;if(this._currentSelection===false){__cov_HjZTx8fE2j7fahookso83Q.b['1'][0]++;__cov_HjZTx8fE2j7fahookso83Q.s['7']++;return;}else{__cov_HjZTx8fE2j7fahookso83Q.b['1'][1]++;}__cov_HjZTx8fE2j7fahookso83Q.s['8']++;var w=1200;__cov_HjZTx8fE2j7fahookso83Q.s['9']++;var h=700;__cov_HjZTx8fE2j7fahookso83Q.s['10']++;var dualScreenLeft=window.screenLeft!=undefined?(__cov_HjZTx8fE2j7fahookso83Q.b['2'][0]++,window.screenLeft):(__cov_HjZTx8fE2j7fahookso83Q.b['2'][1]++,screen.left);__cov_HjZTx8fE2j7fahookso83Q.s['11']++;var dualScreenTop=window.screenTop!=undefined?(__cov_HjZTx8fE2j7fahookso83Q.b['3'][0]++,window.screenTop):(__cov_HjZTx8fE2j7fahookso83Q.b['3'][1]++,screen.top);__cov_HjZTx8fE2j7fahookso83Q.s['12']++;var width=window.innerWidth?(__cov_HjZTx8fE2j7fahookso83Q.b['4'][0]++,window.innerWidth):(__cov_HjZTx8fE2j7fahookso83Q.b['4'][1]++,document.documentElement.clientWidth?(__cov_HjZTx8fE2j7fahookso83Q.b['5'][0]++,document.documentElement.clientWidth):(__cov_HjZTx8fE2j7fahookso83Q.b['5'][1]++,screen.width));__cov_HjZTx8fE2j7fahookso83Q.s['13']++;var height=window.innerHeight?(__cov_HjZTx8fE2j7fahookso83Q.b['6'][0]++,window.innerHeight):(__cov_HjZTx8fE2j7fahookso83Q.b['6'][1]++,document.documentElement.clientHeight?(__cov_HjZTx8fE2j7fahookso83Q.b['7'][0]++,document.documentElement.clientHeight):(__cov_HjZTx8fE2j7fahookso83Q.b['7'][1]++,screen.height));__cov_HjZTx8fE2j7fahookso83Q.s['14']++;var left=width/2-w/2+dualScreenLeft;__cov_HjZTx8fE2j7fahookso83Q.s['15']++;var top=height/2-h/2+dualScreenTop;__cov_HjZTx8fE2j7fahookso83Q.s['16']++;var newWindow=window.open(this._getIframeURL(),M.util.get_string('browse_and_embed',COMPONENTNAME),'scrollbars=no, width='+w+', height='+h+', top='+top+', left='+left);__cov_HjZTx8fE2j7fahookso83Q.s['17']++;window.buttonJs=this;__cov_HjZTx8fE2j7fahookso83Q.s['18']++;if(window.focus){__cov_HjZTx8fE2j7fahookso83Q.b['8'][0]++;__cov_HjZTx8fE2j7fahookso83Q.s['19']++;newWindow.focus();}else{__cov_HjZTx8fE2j7fahookso83Q.b['8'][1]++;}__cov_HjZTx8fE2j7fahookso83Q.s['20']++;this.embedWindow=newWindow;},_getIframeURL:function(){__cov_HjZTx8fE2j7fahookso83Q.f['4']++;__cov_HjZTx8fE2j7fahookso83Q.s['21']++;var args=Y.mix({elementid:this.get('host').get('elementid'),contextid:this.get('contextid'),height:'600px',width:'1112px'},this.get('area'));__cov_HjZTx8fE2j7fahookso83Q.s['22']++;return M.cfg.wwwroot+'/lib/editor/atto/plugins/kalturamedia/ltibrowse_container.php?'+Y.QueryString.stringify(args);},_getCourseId:function(){__cov_HjZTx8fE2j7fahookso83Q.f['5']++;__cov_HjZTx8fE2j7fahookso83Q.s['23']++;var courseId;__cov_HjZTx8fE2j7fahookso83Q.s['24']++;var bodyClasses=document.getElementsByTagName('body')[0].className;__cov_HjZTx8fE2j7fahookso83Q.s['25']++;var classes=bodyClasses.split(' ');__cov_HjZTx8fE2j7fahookso83Q.s['26']++;for(i in classes){__cov_HjZTx8fE2j7fahookso83Q.s['27']++;if(classes[i].indexOf('course-')>-1){__cov_HjZTx8fE2j7fahookso83Q.b['9'][0]++;__cov_HjZTx8fE2j7fahookso83Q.s['28']++;var parts=classes[i].split('-');__cov_HjZTx8fE2j7fahookso83Q.s['29']++;courseId=parts[1];}else{__cov_HjZTx8fE2j7fahookso83Q.b['9'][1]++;}}__cov_HjZTx8fE2j7fahookso83Q.s['30']++;return courseId;},_replaceKafUriWithToken:function(sourceUrl,kafUri,kalturaToken){__cov_HjZTx8fE2j7fahookso83Q.f['6']++;__cov_HjZTx8fE2j7fahookso83Q.s['31']++;sourceUrl=this._removeProtocolFromUrl(sourceUrl);__cov_HjZTx8fE2j7fahookso83Q.s['32']++;kafUri=this._removeProtocolFromUrl(kafUri);__cov_HjZTx8fE2j7fahookso83Q.s['33']++;return sourceUrl.replace(kafUri,kalturaToken);},_removeProtocolFromUrl:function(fullUrl){__cov_HjZTx8fE2j7fahookso83Q.f['7']++;__cov_HjZTx8fE2j7fahookso83Q.s['34']++;return fullUrl.replace(/^https?:\/\//,'');},embedItem:function(what,data){__cov_HjZTx8fE2j7fahookso83Q.f['8']++;__cov_HjZTx8fE2j7fahookso83Q.s['35']++;embedInfo={};__cov_HjZTx8fE2j7fahookso83Q.s['36']++;for(param in data){__cov_HjZTx8fE2j7fahookso83Q.s['37']++;var isEmbedInfo=param.split('-');__cov_HjZTx8fE2j7fahookso83Q.s['38']++;if(isEmbedInfo[0]=='embedinfo'){__cov_HjZTx8fE2j7fahookso83Q.b['10'][0]++;__cov_HjZTx8fE2j7fahookso83Q.s['39']++;embedInfo[isEmbedInfo[1]]=data[param];}else{__cov_HjZTx8fE2j7fahookso83Q.b['10'][1]++;}}__cov_HjZTx8fE2j7fahookso83Q.s['40']++;var token=this.get('kalturauritoken');__cov_HjZTx8fE2j7fahookso83Q.s['41']++;var kafUri=this.get('kafuri');__cov_HjZTx8fE2j7fahookso83Q.s['42']++;var sourceUrl=embedInfo.url;__cov_HjZTx8fE2j7fahookso83Q.s['43']++;var url=this._replaceKafUriWithToken(sourceUrl,kafUri,token);__cov_HjZTx8fE2j7fahookso83Q.s['44']++;var parser=document.createElement('a');__cov_HjZTx8fE2j7fahookso83Q.s['45']++;parser.href=sourceUrl;__cov_HjZTx8fE2j7fahookso83Q.s['46']++;url+=parser.search;__cov_HjZTx8fE2j7fahookso83Q.s['47']++;var content='<a href="http://'+url+'">tinymce-kalturamedia-embed||'+embedInfo.title+'||'+embedInfo.width+'||'+embedInfo.height+'</a>';__cov_HjZTx8fE2j7fahookso83Q.s['48']++;host=this.get('host');__cov_HjZTx8fE2j7fahookso83Q.s['49']++;host.setSelection(this._currentSelection);__cov_HjZTx8fE2j7fahookso83Q.s['50']++;host.insertContentAtFocusPoint(content);__cov_HjZTx8fE2j7fahookso83Q.s['51']++;this.markUpdated();__cov_HjZTx8fE2j7fahookso83Q.s['52']++;this.embedWindow.close();}},{ATTRS:{contextid:{value:null},kalturauritoken:{value:null},kafuri:{value:null}}});},'@VERSION@',{'requires':['moodle-editor_atto-plugin']});
