define(["jquery","core/config","core/str","core/notification","theme_bootstrap/bootstrap"],function(a,b,c,d){function e(a,b){var c=(a.getTime()-b.getTime())/1e3;return c/=2419200,c<=0?0:Math.abs(Math.round(c))}return{init:function(b,c){"0"!=b&&0!=b.length&&a('input[type="submit"]').click(function(d){var f=parseInt(b),g="y"==c?12:1,h=f*g,i=a(this),j=0,k=a("#id_completiondate_year").val(),l=a("#id_completiondate_day").val(),m=a("#id_completiondate_month").val();m=parseInt(m)-1;var n=new Date(k,m,l),o=new Date,p=o.getMonth(),q=o.getFullYear(),r=o.getDate(),s=a('input[name="mustendmonth"]').val(),t=a('input[name="requirevalidityperiod"]').val();if("undefined"!=typeof t&&1==t){var u=parseInt(a("#id_validityperiod").val()),v="y"==a("#id_validityperiodunit").val()?12:1;j=u*v}else{"undefined"!=typeof s&&1==s?(p=a("#id_expirymonth").val(),p=parseInt(p)-1,q=a("#id_expiryyear").val(),r=new Date(new Date(q,p,1)-1).getDate()):(p=a("#id_expirydate_month").val(),p=parseInt(p)-1,r=a("#id_expirydate_day").val(),q=a("#id_expirydate_year").val());var w=new Date(q,p,r);j=e(w,n)}j<h?(d.preventDefault(),a("#validity-confirm-modal").modal("show"),a("#validity-confirm-modal").on("click","#validity-confirm-btn",function(){a(this).modal("hide"),i.closest("form").submit()})):i.closest("form").submit()})}}});