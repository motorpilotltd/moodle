define(["jquery","core/config"],function(a,b){return{initialise:function(){var c=null;a("li.aruphonestybox").on("click",'input[type="checkbox"].tapscomplete',function(){return c=a(this),c.data("locked")?!1:(a("#myModal").modal({show:!0}),!1)});var d,e=function(a,b){b===!0?(d=a.text(),a.removeClass("btn-success").addClass("btn-default"),a.text("Sending...")):(a.text(d),a.addClass("btn-success").removeClass("btn-default"))};a(".modal").on("click",".btn-success",function(){var d=a(this);e(d,!0);var f=c.data("instance"),g=a("body").attr("class").toString().replace(/^.*course-(\d+)\s.*$/,"$1");a.post(b.wwwroot+"/mod/aruphonestybox/taps.php",{id:f,course:g}).done(function(b){var f=a.parseJSON(b);e(d,!1);var g=c.parents(".aruphonestybox");g.find(".alert-warning").fadeOut(500),f.success?(c.prop("checked",!0),g.find(".alert-success").hide().removeClass("hide").fadeIn(500),c.parent("div").fadeOut(500)):(g.find(".alert-danger").hide().removeClass("hide").fadeIn(500),c.prop("checked",!1)),a("#myModal").modal("hide")}).fail(function(){e(d,!1)})})}}});