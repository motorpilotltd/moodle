define(["jquery","core/log","jqueryui"],function(a,b){"use strict";function c(b){var c="#threesixty-spiderweb-wrapper-"+b,d=a(".threesixty-spiderweb-wrapper:not("+c+")").fadeOut("slow");d.promise().done(function(){var b=a(c);b.fadeIn("slow").height(1.06*b.width());var d=b.find("img");"undefined"==typeof d.data("src")&&d.resizable({containment:c,aspectRatio:!0})})}return b.debug("mod/threesixty spiderweb"),a.fn.spiderweb=function(){var b=this,d=b.find('select option[value="0"]');b.children("select").change(function(){c(a(this).find(":selected").val())});var e=[];return a("img.threesixty-spiderweb").each(function(){var c=a(this),f=c.data("id");e[f]={},e[f].that=c,e[f].image=new Image,e[f].image.id=f,e[f].image.onload=function(){var c=this.id,f=e[c].that,g=a(this);g.removeAttr("id"),g.width(640),g.height(672),g.attr("class",f.attr("class")),f.replaceWith(g),d.data("count",d.data("count")+1),d.text(d.data("text").replace("[[x]]",d.data("count"))),d.data("count")===d.data("total")&&d.remove();var h=b.find('select option[value="'+c+'"]');if(h.text(h.data("title")).prop("disabled",!1),g.is(":visible")){var i=g.parents(".threesixty-spiderweb-wrapper");a(i).height(1.06*a(i).width()),g.resizable({containment:i,aspectRatio:!0})}},e[f].image.src=e[f].that.data("src")}),b},{init:function(c){a("#threesixty-spiderweb-select").spiderweb(),b.debug("mod/threesixty spiderweb init")}}});