define(["jquery","core/custom_interaction_events"],function(a,b){var c={ZONE_CONTAINER:'[data-region="zone"]',PANEL_ROW_CONTAINER:'[data-region="panel-row"]',PREVEW_PANELS:'[data-region="previewpanels"]',COLLAPSE_ACTIONS:".collapsible-actions",EDIT_PANEL:'[data-action="editpanel"]',DELETE_PANEL:'[data-action="deletepanel"]',EDIT_HEADING:'[data-region="currentform"]',FIELDSETS:"fieldset.collapsible",DATASOURCEMODESELECT:".datasourcemodeselector select",DATASOURCETYPESELECT:".datasourcetypeselector select"},d=function(b,d,e){var f=c.ZONE_CONTAINER+", "+c.PANEL_ROW_CONTAINER+", "+c.EDIT_PANEL;b.find(f).each(function(b,c){a(c).removeClass("border-warning").removeClass("bg-gray010")}),e?d.closest(c.PANEL_ROW_CONTAINER).find(f).each(function(b,c){a(c).addClass("border-warning").addClass("bg-gray010")}):d.addClass("border-warning").addClass("bg-gray010")},e=function(e){b.define(e,[b.events.activate]);var f=function(b){var c=b.data("panelid"),d=b.data("zoneid"),e=b.val();a("span.datasourceconfig").toggleClass("d-none",!0),a("span.datasourceconfig.panel-"+c+"-zone-"+d+"-"+e).toggleClass("d-none",!1)},g=function(b){var c=b.data("panelid"),d=10==b.val(),e="fieldset.collapsible#id_panel-"+c+"-zone-0";a(e).toggleClass("collapsed",d).toggleClass("d-none",d),d||f(a(e).find(".datasourcetypeselector select"))};e.on(b.events.activate,c.ZONE_CONTAINER+","+c.EDIT_PANEL,function(b,h){var i=a(b.target).closest(c.ZONE_CONTAINER+","+c.EDIT_PANEL),j=i.attr("data-zone"),k=i.closest(c.PANEL_ROW_CONTAINER),l=k.attr("data-panelid"),m=10==a('select[name="panel-'+l+'-datasourcemode"]').val();a("fieldset.collapsible").toggleClass("collapsed",!0);var n="#id_panel-"+l;void 0!==j&&m&&(n+="-zone-"+j),m||(n+=", "+n+"-zone-0");var o=e.find(n),p=e.find(c.EDIT_HEADING),q="Panel "+l;void 0!==j&&m&&(q+=" Zone "+j),p.html(q),o.removeClass("d-none").removeClass("collapsed");var r=o.find(c.DATASOURCEMODESELECT),s=o.find(c.DATASOURCETYPESELECT);g(r),f(s),a(n).toggleClass("collapsed",!1),a('[data-region="submitcancel"]').removeClass("d-none").addClass("d-flex"),d(e,i,!m),h.originalEvent.preventDefault()}),e.on(b.events.activate,c.DELETE_PANEL,function(b){var d=a(b.target).closest(c.DELETE_PANEL),f=d.closest(c.PANEL_ROW_CONTAINER),g=f.attr("data-panelid"),h='fieldset[id^="id_panel-'+g+'"], [data-panelid="'+g+'"]';e.find(h).remove()}),e.on("change",c.DATASOURCEMODESELECT,function(b){var f=a(b.target).closest(c.DATASOURCEMODESELECT);g(f);var h=10==f.val(),i=f.attr("data-panelid"),j=a(c.PANEL_ROW_CONTAINER+'[data-panelid="'+i+'"] '+c.EDIT_PANEL);d(e,j,!h)}),e.on("change",c.DATASOURCETYPESELECT,function(b){var d=a(b.target).closest(c.DATASOURCETYPESELECT);f(d)})},f=function(b){b=a(b),b.find(c.COLLAPSE_ACTIONS).addClass("d-none"),e(b)};return{init:f}});