define(["jquery","core/config"],function(a,b){return{replacestrings:function(){var c=a("[name=appraisalid]").val(),d=a("[name=view]").val(),e=[];c&&a("#emailmsg .language").each(function(){var f=a(this).prop("class").match(/language-(\w*)/);return e[f[1]]===!0?!0:(e[f[1]]=!0,void a.ajax({type:"POST",url:b.wwwroot+"/local/onlineappraisal/ajax.php?sesskey="+b.sesskey,data:{c:"feedback",a:"get_placeholders",appraisalid:c,view:d,fblang:f[1]},success:function(b){var c=b.data;a("#emailmsg ."+f[0]+" .placeholder").each(function(){var b=a(this),d=b.html().replace("{{","").replace("}}","");c[d]&&(d=c[d]),b.text(d),a(this).addClass("visible")})}}))}),a("#id_language").on("change",function(){var b=a(this),c=b.val(),d="language-"+c;a("#emailmsg .language").each(function(){var b=a(this);b.hasClass(d)?b.removeClass("hidden"):b.addClass("hidden")})}),a("#id_firstname").on("input",function(){var b=a(this);a(".bind_firstname").each(function(){a(this).text(" "+b.val())}),""!==b.val()&&""!==a("#id_lastname").val()?(a("#editmsg").removeClass("disabled"),a("#editmsg").tooltip("destroy")):a("#editmsg").addClass("disabled")}),a("#id_lastname").on("input",function(){var b=a(this);a(".bind_lastname").each(function(){a(this).text(" "+b.val())}),""!==b.val()&&""!==a("#id_firstname").val()?(a("#editmsg").removeClass("disabled"),a("#editmsg").tooltip("destroy")):a("#editmsg").addClass("disabled")}),a("#editmsg").addClass("disabled"),a("#editmsg").tooltip(),a("#editmsg").on("click",function(){if(!a(this).hasClass("disabled")){a("#emailmsg .ignoreoncopy").remove();var b=a("#id_language").val(),c=".language-"+b;a("#emailmsg p").each(function(){a(this).replaceWith(a(this).text()+"\n")});var d=a("#emailtextstart "+c).text(),e=a("#emailtextend "+c).text();a("#emailmsg").addClass("hidden"),a("#customemailmsg").removeClass("hidden"),a("#hascustomemail").val(1),a("#id_customemailmsg").val(d+e)}})}}});