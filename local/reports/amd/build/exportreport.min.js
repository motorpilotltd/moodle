define(["jquery","core/config","core/str","core/notification","core/log"],function(a,b,c,d,e){return{init:function(f){e.debug("Listening to the exportreport btn"),a("#exportreport").click(function(g){g.preventDefault(),a(this).data("processing")||a(this).hasClass("disabled")||(a("#exportmodal").modal(),c.get_string("error:request","local_onlineappraisal").done(function(c){a.ajax({type:"POST",url:b.wwwroot+"/local/reports/ajax.php?sesskey="+b.sesskey,data:{page:f},success:function(b){"object"!=typeof b&&(b={success:!1,message:c,data:""}),b.success?(a("#downloadlinkcontainer").removeClass("hidden"),a("#downloadlink").attr("href",b.data.url),a("#downloadlink").html(b.data.filename),a("#closedownloadmodal").removeClass("disabled"),e.debug(b.message)):e.debug("nosuccess"),e.debug(b.message)},error:function(){e.debug("error in ajax exportreports")}})}).fail(d.exception))})}}});