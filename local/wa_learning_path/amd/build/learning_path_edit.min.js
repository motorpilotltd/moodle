define(["jquery","theme_bootstrap/bootstrap"],function(a,t){"use strict";return{init:function(){var t=function(t,e){var i,l=o(t),n=a(".wa_matrix .col_header").length,d=parseInt(e)+1;if(l<d)for(i=2;i<n+1;i++)i>=l&&i<d&&a(".wa_matrix > div").each(function(t){a(this).find("> div:nth-child("+parseInt(i)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(i)+1)+")"))});if(l>d)for(i=parseInt(n)+1;i>1;i--)i<=l&&i>d&&a(".wa_matrix > div").each(function(t){a(this).find("> div:nth-child("+parseInt(i)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(i)-1)+")"))})},e=function(t,e){var i,o=l(t),n=a(".wa_matrix .wa_row").length,d=parseInt(e)+1;if(o<d)for(i=2;i<n+1;i++)i>=o&&i<d&&a(".wa_matrix").each(function(t){a(this).find("> div:nth-child("+parseInt(i)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(i)+1)+")"))});if(o>d)for(i=parseInt(n)+1;i>1;i--)i<=o&&i>d&&a(".wa_matrix").each(function(t){a(this).find("> div:nth-child("+parseInt(i)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(i)-1)+")"))})},i=function(){var t=0,e=a(".wa_row").length;a(".wa_row .row_header").each(function(){t+=a(this).height()}),a(".wa_row .row_header").each(function(){a(this).height(t/e),a(this).width(120)});var i=a("#main").width()-55,o=a(".col_header").length-1;a(".col_header").each(function(){a(this).width(i/o)}),a(".cell").each(function(){a(this).attr("style","width: "+i/o+"px !important;height: "+t/e+"px !important;")}),a(".add_row").width(a(".wa_matrix").width()-20)},o=function(t){var e=a("#"+t),i=a(".wa_matrix .cols .col_header").index(e);return parseInt(i)+2},l=function(t){var e=a("#"+t),i=a(".wa_matrix .wa_row").index(e);return parseInt(i)+2},n=function(t,e,i){"column"==i&&(1==e?a("#"+t).attr("show","yes"):a("#"+t).attr("show","no")),"row"==i&&(1==e?(a("#"+t+" .row_header").attr("show","yes"),a("#"+t).hasClass("greyed")&&a("#"+t).removeClass("greyed")):(a("#"+t+" .row_header").attr("show","no"),a("#"+t).hasClass("greyed")||a("#"+t).addClass("greyed"))),d()},d=function(){a(".wa_matrix .cell").removeClass("greyed"),a('.wa_matrix .col_header[show="no"]').each(function(){var t=a(".wa_matrix .cols .col_header").index(this),e=parseInt(t)+2;a(".wa_matrix > div > div:nth-child("+e+")").addClass("greyed")})};a.fn.swapWith=function(t){return this.each(function(){var e=a(t).clone(!0),i=a(this).clone(!0);a(t).replaceWith(i),a(this).replaceWith(e)})},a(document).ready(function(a){a('.col_header a[data-toggle="modal"]').on("click",function(){var t=a(this).parent().parent().parent().attr("id"),e=a("#"+t+" .name .tooltip").text(),i=a("#"+t).attr("description"),l=a("#"+t+" .select").val();return a("#myModalColumn #delete").attr("data-id",t),a("#myModalColumn #save").attr("data-id",t),a("#myModalColumn #name").val(e),a("#myModalColumn #description").val(i),a("#myModalColumn #position").val(o(t)-1),a("#myModalColumn #regions").val(l),"yes"==a("#"+t).attr("show")?a("#myModalColumn #visible").prop("checked",!0):a("#myModalColumn #visible").prop("checked",!1),a("#myModalColumn").modal("show"),!1}),a("#myModalColumn #delete").on("click",function(){var t=a(this).attr("data-id"),e=a("#"+t),o=a(".wa_matrix .cols .col_header").index(e),l=parseInt(o)+2;a(".wa_matrix > div > div:nth-child("+l+")").remove(),a("#myModalColumn").modal("hide"),i()}),a("#myModalColumn #cancel").on("click",function(){a("#myModalColumn").modal("hide")}),a("#myModalColumn #save").on("click",function(){var e=a("#myModalColumn #description").val(),i=a("#myModalColumn #name").val(),o=i.replace(/^(.{18}[.]*).*/,"$1");o.length<i.length&&(o+="...");var l=a("#myModalColumn #position").val(),d=a(this).attr("data-id"),h=a("#myModalColumn #visible").is(":checked"),r=a("#myModalColumn #regions").val();a("#"+d+" .m3 span").each(function(){a(this).hasClass("hide")||a(this).addClass("hide")}),r.forEach(function(t){a("#"+d+' .m3 span[id="'+t+'"]').removeClass("hide")}),a("#"+d).attr("description",e),a("#"+d+" .name .tooltip").text(i),a("#"+d+" .name .text").text(o),a("#"+d+" .select").val(r),t(d,l),n(d,h,"column"),a("#myModalColumn").modal("hide")}),a('.row_header a[data-toggle="modal"]').on("click",function(){var t=a(this).parent().parent().parent().attr("id"),e=a("#"+t+" .name .tooltip").text();return a("#myModalRow #delete").attr("data-id",t),a("#myModalRow #save").attr("data-id",t),a("#myModalRow #name").val(e),a("#myModalRow #position").val(l(t)-1),"yes"==a("#"+t+" .row_header").attr("show")?a("#myModalRow #visible").prop("checked",!0):a("#myModalRow #visible").prop("checked",!1),a("#myModalRow").modal("show"),!1}),a("#myModalRow #delete").on("click",function(){var t=a(this).attr("data-id");a("#"+t).remove(),a("#myModalRow").modal("hide")}),a("#myModalRow #cancel").on("click",function(){a("#myModalRow").modal("hide")}),a("#myModalRow #save").on("click",function(){var t=a("#myModalRow #name").val(),i=t.replace(/^(.{20}[.]*).*/,"$1");i.length<t.length&&(i+="...");var o=a("#myModalRow #position").val(),l=a(this).attr("data-id"),d=a("#myModalRow #visible").is(":checked");a("#"+l+" .name .tooltip").text(t),a("#"+l+" .name .text").text(i),e(l,o),n(l,d,"row"),a("#myModalRow").modal("hide")}),a(".cell").on("mouseenter",function(){var t=a(this).data("column"),e=a(this).parent().attr("id");a(".cell").each(function(){a(this).removeClass("cell-highlight"),a(this).removeClass("marked-cell"),a(this).data("column")==t&&a(this).addClass("cell-highlight"),a(this).data("row")==e&&a(this).addClass("cell-highlight")}),a(".col_header").each(function(){a(this).removeClass("cell-highlight"),a(this).attr("id")==t&&a(this).addClass("cell-highlight")});e=a(this).data("row");a(".row_header").each(function(){a(this).removeClass("cell-highlight"),a(this).data("row")==e&&a(this).addClass("cell-highlight")}),a(this).removeClass("cell-highlight"),a(this).addClass("marked-cell")})})}}});