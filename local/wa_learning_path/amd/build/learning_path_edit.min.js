define(["jquery","theme_bootstrap/bootstrap","local_wa_learning_path/edit-matrix-modal","local_wa_learning_path/helper","local_wa_learning_path/edit-matrix-actions","core/str"],function(t,i,a,e,o,n){"use strict";return{init:function(i,e,n,c,l,d,r,s,h,u,m,v,f,y,_,g,w,p,k,C,b,M,x,R,A,T,E){t(document).ready(function(t){o.initVariables(n,y,w,p,k,C,b,M,x,r),i.forEach(function(t){o.addColumn(t)}),e.forEach(function(t){o.addRow(t,c,l,d,v,E)}),o.waCheckIcons(c,s,h,u,m),t('#dialog_create_activity input[name="title"]').change(o.titleValidation()),t('#dialog_create_activity input[name="title"]').blur(o.titleValidation()),t("#activitiyform .fstatic").html(t("#wa_activity_form").html()),_&&(t("#editing_matrix .add_row").click(function(){var i=o.addRow({show:1,name:R},c,l,d,v,E);t('div[data-row="'+i+'"] a[data-toggle="modal"]').on("click",function(){return a.loadModalRow(i)})}),t("#editing_matrix .add_column").click(function(){var i=o.addColumn({show:1,name:A,region:["0"],isnew:1},d);t("#"+i+' a[data-toggle="modal"]').on("click",function(){return a.loadModalColumn(i)})})),t("#id_submitbutton, #id_submitbutton2, #id_submitbutton3").click(function(){o.waSave()}),t("#id_acancel").attr("onclick",""),t("#id_acancel").click(function(){return location.hash="#cancel",t('#matrixform input[name="returnhash"]').val(""),!1}),t("#id_asubmitbutton").click(function(){return t('#matrixform input[name="returnhash"]').val(location.hash),o.saveActivity(),!1}),t("#activitiyform .wa_tabs a:nth-child(1)").click(function(){return t("#activitiyform .wa_tabs a").removeClass("current"),t(this).addClass("current"),t("#activitiyform .activity.tab").hide(),t("#activitiyform .modules.tab").show(),!1}),t("#activitiyform .wa_tabs a:nth-child(2)").click(function(){return t("#activitiyform .wa_tabs a").removeClass("current"),t(this).addClass("current"),t("#activitiyform .modules.tab").hide(),t("#activitiyform .activity.tab").show(),!1}),t.expr[":"].contains=t.expr.createPseudo(function(i){return function(a){return t(a).text().toUpperCase().indexOf(i.toUpperCase())>=0}}),t("#activitiyform .selectpicker").keypress(function(t){if("13"==t.keyCode)return!1}),t("#activitiyform .selectpicker").keyup(function(){var i=t(this).val(),a=t(this).parent().parent().find(".results");i.length?(a.find("a").hide(),a.find('a:contains("'+i+'")').show(),a.find('a:contains("'+i+'")').length?a.find("span").hide():a.find("span").show(),a.slideDown()):a.hide()}),t("#activitiyform .modules .results a").click(function(){var i={courseid:t(this).attr("courseid"),html:t(this).html(),methodology:t(this).attr("methodology")};return o.setModule(JSON.stringify(i)),t("#activitiyform .modules .results a").removeClass("selected"),t(this).addClass("selected"),t("#activitiyform .modules button").show(),!1}),t("#activitiyform .activity .results a").click(function(){var i={activityid:t(this).attr("activityid"),html:t(this).html()};return o.setToAddActivity(JSON.stringify(i)),t("#activitiyform .activity .results a").removeClass("selected"),t(this).addClass("selected"),t("#activitiyform .activity button").show(),!1}),t("#activitiyform .modules button.to_add").click(function(){var i=o.getModule();return i?o.addModule(i.courseid,t(".modules.tab").find("select").val(),i.html,i.methodology,1)&&(t("span.add_info").show(),setTimeout(function(){t("span.add_info").hide()},3e3)):o.chooseElementToAdd(),!1}),t("#activitiyform .activity button.to_add").click(function(){var i=o.getToAddActivity();return i?o.addActivity(i.activityid,t(".activity.tab").find("select").val(),i.html,t('input[name="percent"]:checked').val(),1)&&(t("span.add_info").show(),setTimeout(function(){t("span.add_info").hide()},3e3)):o.chooseElementToAdd(),!1}),t("#dialog_create_activity_id .wa_blue_button").click(function(t){return t.preventDefault(),o.saveNewActivity(v,f),!1}),t('input[name="activitydraftid"]').val(g),window.onhashchange=function(){o.editActivity()},T||(location.hash="#"),t('.col_header a[data-toggle="modal"]').on("click",function(){var i=t(this).parent().parent().parent().attr("id");return a.loadModalColumn(i)}),t("#myModalColumn #delete").on("click",function(){var i=t(this).attr("data-id");a.initialiseRemoveColumn(i)}),t("#myModalColumn #cancel").on("click",function(){t("#myModalColumn").modal("hide")}),t("#myModalColumn #save").on("click",function(){var i=t(this).attr("data-id");a.saveColumn(i)}),t(".activity .add_activity").on("click",function(){return o.createActivity(),!1}),t('.row_header a[data-toggle="modal"]').on("click",function(){var i=t(this).parent().parent().parent().attr("id");return a.loadModalRow(i)}),t("#myModalRow #delete").on("click",function(){var i=t(this).attr("data-id");a.initialiseRemoveRow(i)}),t("#myModalRow #cancel").on("click",function(){t("#myModalRow").modal("hide")}),t("#myModalRow #save").on("click",function(){var i=t(this).attr("data-id");a.saveRow(i)}),t('select[name="roles"]').change(function(){var i="",a=t(this).data("url");t("#editing_matrix .roles").val()&&(i=t("#editing_matrix .roles").val()),i>0&&(a+="&role="+i),window.location=a}),t(".cell").on("mouseenter",function(){var i=t(this).data("column"),a=t(this).parent().attr("id");t(".cell").each(function(){t(this).removeClass("cell-highlight"),t(this).removeClass("marked-cell"),t(this).data("column")==i&&t(this).addClass("cell-highlight"),t(this).data("row")==a&&t(this).addClass("cell-highlight")}),t(".col_header").each(function(){t(this).removeClass("cell-highlight"),t(this).attr("id")==i&&t(this).addClass("cell-highlight")});a=t(this).data("row");t(".row_header").each(function(){t(this).removeClass("cell-highlight"),t(this).data("row")==a&&t(this).addClass("cell-highlight")}),t(this).removeClass("cell-highlight"),t(this).addClass("marked-cell")})})}}});