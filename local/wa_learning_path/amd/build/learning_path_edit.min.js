define(["jquery","theme_bootstrap/bootstrap"],function(a,t){"use strict";return{init:function(){var t=function(t,e){var o,n=i(t),l=a(".wa_matrix .col_header").length,d=parseInt(e)+1;if(n<d)for(o=2;o<l+1;o++)o>=n&&o<d&&a(".wa_matrix > div").each(function(t){a(this).find("> div:nth-child("+parseInt(o)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(o)+1)+")"))});if(n>d)for(o=parseInt(l)+1;o>1;o--)o<=n&&o>d&&a(".wa_matrix > div").each(function(t){a(this).find("> div:nth-child("+parseInt(o)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(o)-1)+")"))})},e=function(t,e){var o,i=n(t),l=a(".wa_matrix .wa_row").length,d=parseInt(e)+1;if(i<d)for(o=2;o<l+1;o++)o>=i&&o<d&&a(".wa_matrix").each(function(t){a(this).find("> div:nth-child("+parseInt(o)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(o)+1)+")"))});if(i>d)for(o=parseInt(l)+1;o>1;o--)o<=i&&o>d&&a(".wa_matrix").each(function(t){a(this).find("> div:nth-child("+parseInt(o)+")").swapWith(a(this).find("> div:nth-child("+(parseInt(o)-1)+")"))})},o=function(){var t=0,e=a(".wa_row").length;a(".wa_row .row_header").each(function(){t+=a(this).height()}),a(".wa_row .row_header").each(function(){a(this).height(t/e),a(this).width(120)});var o=a(".cols").width()-120,i=a(".col_header").length-1;a(".col_header").each(function(){a(this).width(o/i)}),a(".cell").each(function(){a(this).attr("style","width: "+o/i+"px !important;height: "+t/e+"px !important;")}),a(".add_row").width(a(".wa_matrix").width()-20)},i=function(t){var e=a("#"+t),o=a(".wa_matrix .cols .col_header").index(e);return parseInt(o)+2},n=function(t){var e=a("#"+t),o=a(".wa_matrix .wa_row").index(e);return parseInt(o)+2},l=function(t,e,o){"column"==o&&(1==e?a("#"+t).attr("show","yes"):a("#"+t).attr("show","no")),"row"==o&&(1==e?(a("#"+t+" .row_header").attr("show","yes"),a("#"+t).hasClass("greyed")&&a("#"+t).removeClass("greyed")):(a("#"+t+" .row_header").attr("show","no"),a("#"+t).hasClass("greyed")||a("#"+t).addClass("greyed"))),d()},d=function(){a(".wa_matrix .cell").removeClass("greyed"),a('.wa_matrix .col_header[show="no"]').each(function(){var t=a(".wa_matrix .cols .col_header").index(this),e=parseInt(t)+2;a(".wa_matrix > div > div:nth-child("+e+")").addClass("greyed")})};a.fn.swapWith=function(t){return this.each(function(){var e=a(t).clone(!0),o=a(this).clone(!0);a(t).replaceWith(o),a(this).replaceWith(e)})},a(document).ready(function(a){a('.col_header a[data-toggle="modal"]').on("click",function(){var t=a(this).parent().parent().parent().attr("id"),e=a("#"+t+" .name .tooltip").text();return a("#myModalColumn #delete").attr("data-id",t),a("#myModalColumn #save").attr("data-id",t),a("#myModalColumn #name").val(e),a("#myModalColumn #position").val(i(t)-1),"yes"==a("#"+t).attr("show")?a("#myModalColumn #visible").prop("checked",!0):a("#myModalColumn #visible").prop("checked",!1),a("#myModalColumn").modal("show"),!1}),a("#myModalColumn #delete").on("click",function(){var t=a(this).attr("data-id"),e=a("#"+t),i=a(".wa_matrix .cols .col_header").index(e),n=parseInt(i)+2;a(".wa_matrix > div > div:nth-child("+n+")").remove(),a("#myModalColumn").modal("hide"),o()}),a("#myModalColumn #cancel").on("click",function(){a("#myModalColumn").modal("hide")}),a("#myModalColumn #save").on("click",function(){var e=a("#myModalColumn #name").val(),o=e.replace(/^(.{18}[.]*).*/,"$1");o.length<e.length&&(o+="...");var i=a("#myModalColumn #position").val(),n=a(this).attr("data-id"),d=a("#myModalColumn #visible").is(":checked");a("#"+n+" .name .tooltip").text(e),a("#"+n+" .name .text").text(o),t(n,i),l(n,d,"column"),a("#myModalColumn").modal("hide")}),a('.row_header a[data-toggle="modal"]').on("click",function(){var t=a(this).parent().parent().parent().attr("id"),e=a("#"+t+" .name .tooltip").text();return a("#myModalRow #delete").attr("data-id",t),a("#myModalRow #save").attr("data-id",t),a("#myModalRow #name").val(e),a("#myModalRow #position").val(n(t)-1),"yes"==a("#"+t+" .row_header").attr("show")?a("#myModalRow #visible").prop("checked",!0):a("#myModalRow #visible").prop("checked",!1),a("#myModalRow").modal("show"),!1}),a("#myModalRow #delete").on("click",function(){var t=a(this).attr("data-id");a("#"+t).remove(),a("#myModalRow").modal("hide")}),a("#myModalRow #cancel").on("click",function(){a("#myModalRow").modal("hide")}),a("#myModalRow #save").on("click",function(){var t=a("#myModalRow #name").val(),o=t.replace(/^(.{20}[.]*).*/,"$1");o.length<t.length&&(o+="...");var i=a("#myModalRow #position").val(),n=a(this).attr("data-id"),d=a("#myModalRow #visible").is(":checked");a("#"+n+" .name .tooltip").text(t),a("#"+n+" .name .text").text(o),e(n,i),l(n,d,"row"),a("#myModalRow").modal("hide")}),a(".cell").on("mouseenter",function(){var t=a(this).data("column");a(".cell").each(function(){a(this).removeClass("cell-highlight"),a(this).data("column")==t&&a(this).addClass("cell-highlight")}),a(this).parent().find(".cell").addClass("cell-highlight")})})}}});