define(["jquery","local_search/searchtabs"],function(a,b){function c(){this.active=!0,this.loading=!1,this.container=null,this.resultsSelector=null,this.tab=null;var b=this;this.handleScroll=function(){return b.loading?!1:(b.activateScrollable(),void(b.atBottom()&&b.loadMore()))},a(document).on("scroll",this.handleScroll),a(document).on("tabchanged",function(){b.loading=!1})}return c.prototype.activateScrollable=function(){var c=a(".tab-container .tab-content.open");this.container=a(c.data("resultsContainer")),this.resultsSelector=c.data("resultElement"),this.tab=b.findSearchTab(this.container)},c.prototype.atBottom=function(){var b=this.container.find(this.resultsSelector).last(),c=a(window),d=b.offset().top,e=c.scrollTop()+c.height();return e>d},c.prototype.hasMore=function(){var a=this.tab.totalResults,b=this.tab.contentTab.find(this.resultsSelector).length;return a>b},c.prototype.loadMore=function(){var a=this;return!1===this.hasMore()?!1:(this.loading=!0,void this.tab.setPage(this.tab.page+1).load({append:this.resultsSelector,loader:!0}).done(function(b){a.loaded(b)}))},c.prototype.loaded=function(a){this.loading=!1,this.tab.contentTab.find(".description").collapser({mode:"lines",truncate:3,hideText:"Show less",speed:"medium"})},{apply:function(){new c}}});