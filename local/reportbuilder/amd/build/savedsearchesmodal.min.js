define(["jquery","core/modal_factory","core/templates","core/str","core/notification","core/modal_events"],function(a,b,c,d,e,f){var g={init:function(c){var g=a("div.managesavedsearches button"),h=d.get_string("savedsearches","local_reportbuilder").fail(e.exception),i=a.ajax({url:M.cfg.wwwroot+"/local/reportbuilder/savedsearches.php?id="+c.toString()}).fail(e.exception);b.create({title:h,body:i,type:b.types.DEFAULT},g),a("body").on("click","a.delete-search",function(g){g.preventDefault();var h=d.get_string("confirm").fail(e.exception),i=a(this).attr("data-searchid"),j=a.ajax({url:M.cfg.wwwroot+"/local/reportbuilder/savedsearches.php?action=delete&id="+c.toString()+"&sid="+i}).fail(e.exception);b.create({type:b.types.CONFIRM,title:h,body:j}).done(function(b){b.getRoot().on(f.yes,function(){a.ajax({url:M.cfg.wwwroot+"/local/reportbuilder/savedsearches.php?sesskey="+M.cfg.sesskey+"&confirm=true&action=delete&id="+c.toString()+"&sid="+i}).fail(e.exception).then(function(){a(".savedsearchid_"+i).remove()})}),b.show(),b.getRoot().on(f.hidden,function(){b.destroy()})})}),a("body").on("click","a.edit-search",function(g){g.preventDefault();var h=d.get_string("savedsearches","local_reportbuilder").fail(e.exception),i=a(this).attr("data-searchid"),j=a.ajax({url:M.cfg.wwwroot+"/local/reportbuilder/savedsearches.php?action=edit&id="+c.toString()+"&sid="+i}).fail(e.exception);b.create({type:b.types.SAVE_CANCEL,title:h,body:j}).done(function(b){b.getRoot().on(f.save,function(){var b=a("#id_name").val(),f=a("#id_ispublic").val();a.ajax({url:M.cfg.wwwroot+"/local/reportbuilder/savedsearches.php?sesskey="+M.cfg.sesskey+"&confirm=true&action=edit&id="+c.toString()+"&sid="+i+"&name="+b+"&ispublic="+f}).fail(e.exception).then(function(){a(".savedsearchid_"+i+" .c0").text(b),1==f?d.get_string("yes").then(function(b){a(".savedsearchid_"+i+" .c1").text(b)}):d.get_string("no").then(function(b){a(".savedsearchid_"+i+" .c1").text(b)})})}),b.getRoot().on(f.hidden,function(){b.destroy()}),b.show()})})}};return g});