define(["jquery","core/config"],function(a,b){var c=function(c,d,e){a.ajax({url:b.wwwroot+"/local/lynda/ajax.php",type:"POST",data:{sesskey:b.sesskey,action:"setregion",regionid:c,courseid:d,state:e},success:function(){var b='input[data-regionid="'+c+'"][data-courseid="'+d+'"]';a(b).removeAttr("disabled","disabled")}})},d=function(c,d){var e=a("input.regioncheck").map(function(){return a(this).data("courseid")});a.unique(e);var f="",g=!0;e.map(function(){g?(f+=this,g=!1):f+=","+this}),a.ajax({url:b.wwwroot+"/local/lynda/ajax.php",type:"POST",data:{sesskey:b.sesskey,action:"setregions",regionid:c,courseids:f,state:d},success:function(){var b='input.regionselectall[data-regionid="'+c+'"]';a(b).removeAttr("disabled","disabled");var b='input[data-regionid="'+c+'"]';a(b).prop("checked",d)}})};return{initialise:function(){a(document).on("change","input.regioncheck",function(){a(this).attr("disabled","disabled");var b=a(this).data("regionid"),d=a(this).data("courseid"),e=a(this).is(":checked");c(b,d,e)}),a("input.regionselectall").prop("indeterminate",!0),a(document).on("change","input.regionselectall",function(){a(this).attr("disabled","disabled");var b=a(this).data("regionid"),c=a(this).is(":checked");d(b,c)})}}});